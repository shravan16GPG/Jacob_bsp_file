2025-06-27 05:25:40,637 - [Setup] - INFO - bsp_finder - <module> - 647 - Script execution started.
2025-06-27 05:25:46,617 - [Setup] - INFO - bsp_finder - get_input_csv - 175 - User selected file: 'D:/Work/Freelancing/jacobsawers/csv script/jacob/bet sample.csv'
2025-06-27 05:25:46,619 - [Setup] - INFO - bsp_finder - get_input_csv - 184 - Reading as CSV file...
2025-06-27 05:25:46,619 - [Setup] - DEBUG - bsp_finder - get_input_csv - 190 - CSV: Header: ['Time', 'Venue', 'Code', 'RaceNo', 'RunnerNo', 'RunnerName', 'Type', 'Market', 'Bookie', 'Odds', 'Result']
2025-06-27 05:25:46,646 - [Setup] - INFO - bsp_finder - get_input_csv - 239 - Successfully loaded 3364 tasks from the selected file.
2025-06-27 05:25:46,647 - [Setup] - INFO - bsp_finder - <module> - 656 - Successfully loaded 3364 raw tasks from CSV.
2025-06-27 05:25:46,649 - [Setup] - INFO - bsp_finder - filter_tasks_for_last_n_days - 249 - Date Filter: Starting to filter tasks for the last 8 days (today inclusive).
2025-06-27 05:25:47,433 - [Setup] - INFO - bsp_finder - filter_tasks_for_last_n_days - 267 - Date Filter: Applying date range: >= 20/06/2025 and <= 27/06/2025.
2025-06-27 05:25:47,439 - [Setup] - INFO - bsp_finder - filter_tasks_for_last_n_days - 271 - Date Filter: 2890 tasks were outside the 8-day window and removed.
2025-06-27 05:25:47,439 - [Setup] - INFO - bsp_finder - filter_tasks_for_last_n_days - 272 - Date Filter: 474 tasks remain after date range filtering.
2025-06-27 05:25:47,441 - [Setup] - INFO - bsp_finder - <module> - 669 - 474 tasks to be processed after 8-day filter.
2025-06-27 05:25:47,442 - [Setup] - INFO - bsp_finder - <module> - 670 - --- Starting Scraping Phase 1 (Exact Venue Match) ---
2025-06-27 05:25:47,442 - [Setup] - INFO - bsp_finder - scrape_and_enrich_csv - 417 - [Phase 1 (Exact Venue)] Starting scraping process for 474 tasks... (Fuzzy Venue Matching: False)
2025-06-27 05:25:47,443 - [Setup] - INFO - bsp_finder - setup_driver - 91 - Initializing Chrome WebDriver setup...
2025-06-27 05:25:47,443 - [Setup] - DEBUG - bsp_finder - setup_driver - 98 - WebDriverManager: Installing/Locating ChromeDriver...
2025-06-27 05:25:59,994 - [Setup] - INFO - bsp_finder - setup_driver - 101 - WebDriver setup successful.
2025-06-27 05:25:59,995 - [Setup] - DEBUG - bsp_finder - scrape_and_enrich_csv - 432 - [Phase 1 (Exact Venue)] Preprocessing 'time' for 'date_only' grouping.
2025-06-27 05:26:00,171 - [Setup] - INFO - bsp_finder - scrape_and_enrich_csv - 453 - [Phase 1 (Exact Venue)] Tasks grouped into 19 [Date, Code, Venue] groups.
2025-06-27 05:26:00,171 - [Setup] - INFO - bsp_finder - scrape_and_enrich_csv - 456 - [Phase 1 (Exact Venue)] Navigating to base URL: https://www.betfair.com.au/hub/racing/horse-racing/racing-results/
2025-06-27 05:26:12,795 - [Setup] - CRITICAL - bsp_finder - scrape_and_enrich_csv - 555 - [Phase 1 (Exact Venue)] CRITICAL WebDriverException in main loop: no such window: target window already closed
from unknown error: web view not found
  (Session info: chrome=137.0.7151.120). Aborting phase.
Traceback (most recent call last):
  File "D:\Work\Freelancing\jacobsawers\csv script\jacob\bsp_finder.py", line 457, in scrape_and_enrich_csv
    wait.until(EC.presence_of_element_located((By.CLASS_NAME, "pb-6"))); logger.info(f"[{current_phase_name}] Page loaded: {base_url}")
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\Work\Freelancing\jacobsawers\csv script\.venv\Lib\site-packages\selenium\webdriver\support\wait.py", line 129, in until
    value = method(self._driver)
            ^^^^^^^^^^^^^^^^^^^^
  File "d:\Work\Freelancing\jacobsawers\csv script\.venv\Lib\site-packages\selenium\webdriver\support\expected_conditions.py", line 104, in _predicate
    return driver.find_element(*locator)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\Work\Freelancing\jacobsawers\csv script\.venv\Lib\site-packages\selenium\webdriver\remote\webdriver.py", line 914, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\Work\Freelancing\jacobsawers\csv script\.venv\Lib\site-packages\selenium\webdriver\remote\webdriver.py", line 447, in execute
    self.error_handler.check_response(response)
  File "d:\Work\Freelancing\jacobsawers\csv script\.venv\Lib\site-packages\selenium\webdriver\remote\errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.NoSuchWindowException: Message: no such window: target window already closed
from unknown error: web view not found
  (Session info: chrome=137.0.7151.120)
Stacktrace:
	GetHandleVerifier [0x0x783b03+62899]
	GetHandleVerifier [0x0x783b44+62964]
	(No symbol) [0x0x5b10f3]
	(No symbol) [0x0x58ff59]
	(No symbol) [0x0x624f7e]
	(No symbol) [0x0x63f6a9]
	(No symbol) [0x0x61e306]
	(No symbol) [0x0x5ed670]
	(No symbol) [0x0x5ee4e4]
	GetHandleVerifier [0x0x9e4793+2556483]
	GetHandleVerifier [0x0x9dfd02+2537394]
	GetHandleVerifier [0x0x7aa2fa+220586]
	GetHandleVerifier [0x0x79aae8+157080]
	GetHandleVerifier [0x0x7a141d+184013]
	GetHandleVerifier [0x0x78ba68+95512]
	GetHandleVerifier [0x0x78bc10+95936]
	GetHandleVerifier [0x0x776b5a+9738]
	BaseThreadInitThunk [0x0x764d7ba9+25]
	RtlInitializeExceptionChain [0x0x7739c36b+107]
	RtlClearBits [0x0x7739c2ef+191]

2025-06-27 05:26:12,807 - [Setup] - INFO - bsp_finder - scrape_and_enrich_csv - 558 - [Phase 1 (Exact Venue)] Closing WebDriver session.
2025-06-27 05:26:15,216 - [Setup] - DEBUG - bsp_finder - scrape_and_enrich_csv - 558 - [Phase 1 (Exact Venue)] WebDriver session closed.
2025-06-27 05:26:15,217 - [Setup] - INFO - bsp_finder - scrape_and_enrich_csv - 576 - [Phase 1 (Exact Venue)] Identified 0 unique tasks for potential retry.
2025-06-27 05:26:15,218 - [Setup] - INFO - bsp_finder - scrape_and_enrich_csv - 577 - [Phase 1 (Exact Venue)] Scraping finished. Returning 0 processed rows and 0 tasks for retry.
2025-06-27 05:26:15,218 - [Setup] - INFO - bsp_finder - <module> - 677 - --- Phase 1 Finished. Processed 0 task results. Identified 0 for retry. ---
2025-06-27 05:26:15,219 - [Setup] - INFO - bsp_finder - <module> - 695 - No tasks identified for Phase 2 retry.
2025-06-27 05:26:15,219 - [Setup] - WARNING - bsp_finder - <module> - 705 - No valid results from any scraping phase.
2025-06-27 05:26:15,219 - [Setup] - INFO - bsp_finder - <module> - 707 - Total rows in final output (includes retries): 0
2025-06-27 05:26:15,220 - [Setup] - INFO - bsp_finder - <module> - 739 - --- OVERALL SCRAPING SUMMARY --- Final combined DataFrame is empty. ---
2025-06-27 05:26:15,220 - [Setup] - DEBUG - bsp_finder - format_and_save_data - 583 - Preparing to save data to 'final_results.csv'.
2025-06-27 05:26:15,221 - [Setup] - INFO - bsp_finder - format_and_save_data - 586 - Removed existing output file: 'final_results.csv'.
2025-06-27 05:26:15,221 - [Setup] - WARNING - bsp_finder - format_and_save_data - 601 - No data to save to 'final_results.csv'. Creating empty file with headers.
2025-06-27 05:26:15,226 - [Setup] - INFO - bsp_finder - format_and_save_data - 604 - Saved empty 'final_results.csv' with specified headers.
2025-06-27 05:26:15,226 - [Shutdown] - INFO - bsp_finder - <module> - 751 - Script execution finished.
